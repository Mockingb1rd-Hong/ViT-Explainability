import matplotlib.pyplot as plt

def plot_accuracies():
    chefer_accuracy = [0.6752655538694993, 0.6621143146181082, 0.6514921598381386, 0.6393525543753161, 0.6302478502781993, 0.6186140617096612, 0.52250885179565, 0.37025796661608495, 0.3009610520991401]
    huang_accuracy = [0.6752655538694993, 0.6646433990895296, 0.656044511886697, 0.6621143146181082, 0.6530096105209914, 0.656044511886697, 0.5584218512898331, 0.3894790085988872, 0.3009610520991401]
    skipped_accuracy = [0.6752655538694993, 0.6519979767324229, 0.6358118361153262, 0.6282245827010622, 0.6130500758725341, 0.6049570055639858, 0.5048052604957005, 0.37784522003034904, 0.3009610520991401]
    # chefer_accuracy = [0.6579080343607883, 0.6376958059626073, 0.6291056088933805, 0.6195048004042446, 0.6149570490146539, 0.6028297119757453, 0.5138959070237493, 0.38251642243557354, 0.2986356745831228]
    # huang_accuracy = [0.6579080343607883, 0.6412329459322891, 0.6376958059626073, 0.6437594744820616, 0.6371905002526529, 0.6376958059626073, 0.5432036382011117, 0.38858009095502777, 0.2986356745831228]
    # skipped_accuracy = [0.6579080343607883, 0.6387064173825164, 0.631632137443153, 0.6336533602829711, 0.6265790803436079, 0.6260737746336533, 0.5325922182920667, 0.37645275391611926, 0.2986356745831228]
    steps = [0, 0.05, 0.10, 0.15, 0.20, 0.25, 0.5, 0.75, 1]

    plt.figure(figsize=(10, 6))
    plt.plot(steps, chefer_accuracy, label='Chefer Accuracy', marker='o')
    plt.plot(steps, huang_accuracy, label='Huang Accuracy', marker='s')
    plt.plot(steps, skipped_accuracy, label='Ours Accuracy', marker='^')

    plt.xlabel('Perturbation Steps')
    plt.ylabel('Accuracy')
    plt.title('Accuracy vs Perturbation Steps')
    plt.legend()
    plt.grid(True)
    plt.show()

# Call the function to plot the accuracies
plot_accuracies()