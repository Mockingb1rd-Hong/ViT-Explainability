import matplotlib.pyplot as plt
import numpy as np

def plot_accuracies():
    # chefer_accuracy = [0.6611153166792834, 0.6490032803431743, 0.6424425939944487, 0.6290688872066617, 0.6225082008579359, 0.6078728236184708, 0.5258642442593995, 0.39086550592985114, 0.3020439061317184]
    # huang_accuracy = [0.6611153166792834, 0.6472369417108251, 0.6452182689881403, 0.6469846076204895, 0.6394145849104214, 0.6348725712843806, 0.5508453192026243, 0.3792581377744133, 0.3020439061317184]
    # ours_accuracy = [0.6611153166792834, 0.6472369417108251, 0.6404239212717638, 0.630078223568004, 0.6194801917739087, 0.6144335099671966, 0.5594246782740349, 0.4529396921524098, 0.3020439061317184]
    chefer_accuracy = [0.648539778449144, 0.6283987915407855, 0.6354481369587109, 0.6203423967774421, 0.6153071500503524, 0.6102719033232629, 0.526686807653575, 0.3997985901309164, 0.29506545820745217]
    huang_accuracy = [0.648539778449144, 0.6394763343403826, 0.6394763343403826, 0.6465256797583081, 0.6424974823766365, 0.6424974823766365, 0.553877139979859, 0.3726082578046324, 0.29506545820745217]
    ours_accuracy = [0.648539778449144, 0.6314199395770392, 0.6334340382678751, 0.6233635448136958, 0.6153071500503524, 0.6102719033232629, 0.5629405840886204, 0.4501510574018127, 0.29506545820745217]
    steps = [0, 0.05, 0.10, 0.15, 0.20, 0.25, 0.5, 0.75, 1]

    plt.figure(figsize=(12, 6))
    
    # Plot lines
    plt.plot(steps, chefer_accuracy, label='Chefer Accuracy', marker='o')
    plt.plot(steps, huang_accuracy, label='Huang Accuracy', marker='s')
    plt.plot(steps, ours_accuracy, label='Ours Accuracy', marker='^')

    # Customize x-axis
    plt.xlabel('Perturbation Steps')
    plt.ylabel('Accuracy')
    plt.title('Accuracy vs Perturbation Steps')
    plt.xticks(steps)  # Set the x-tick labels to the steps values
    
    plt.legend()
    plt.grid(True)  # Show grid lines
    plt.show()

# Call the function to plot the accuracies
plot_accuracies()